function result(a) {
    var n = 0,
        g = [],
        p = [],
        m = [],
        r = [],
        s = "<h2>検索結果</h2>";
    for (let e in data)
        for (let t in data[e].list)
            if (a == data[e].list[t].name) {
                document.title = a + "を作るには";
                var u = data[e].list[t].img,
                    o = data[e].list[t].grade,
                    h = data[e].type,
                    l = data[e].list[t].rare,
                    d = data[e].list[t].name,
                    c = data[e].list[t].no,
                    k = data[e].list[t].prop;
                for (var f in data[e].comb) g[f] = data[e].comb[f].n1, p[f] = data[e].comb[f].n2
            }
    for (var e in data)
        if (h == data[e].type) {
            for (var t in data[e].list) o > data[e].list[t].grade ? r[t] = data[e].list[t].grade : o < data[e].list[t].grade && (m[t] = data[e].list[t].grade);
            m = $.grep(m, function(a) {
                return a
            }), r = $.grep(r, function(a) {
                return a
            })
        }
    if ("" == r) var v = 0;
    else v = Math.max.apply(null, r);
    if ("" == m) var y = o;
    else y = Math.min.apply(null, m);
    for (var n in g) {
        var b = [],
            w = [],
            x = [],
            j = [];
        for (var e in data)
            if (g[n] == data[e].type)
                for (var t in data[e].list) b[t] = data[e].list[t];
            else if (p[n] == data[e].type)
            for (var t in data[e].list) w[t] = data[e].list[t];
        for (var e in b)
            for (var t in w) {
                var z = Math.floor((b[e].grade + w[t].grade) / 2 + 1);
                (v < z && z < y && o >= z || v < z && z >= y && y == o) && (x[f] = b[e], j[f] = w[t], f++)
            }
        if (x.length > 0) {
            s += "<article><h3>" + g[n] + "<br>×<br>" + p[n] + "</h3>";
            for (var e in x) s += '<ul class="rare' + x[e].rare.length + " rare" + j[e].rare.length + '"><li><span class="result-name">' + x[e].name + '</span><div class="result-item"><img src="' + x[e].img + '" alt=""><span class="result-rare">' + x[e].rare + '</span><span class="result-grade">Grade <span class="result-grade-num">' + x[e].grade + '</span></span></div></li><li><span class="result-name">' + j[e].name + '</span><div class="result-item"><img src="' + j[e].img + '" alt=""><span class="result-rare">' + j[e].rare + '</span><span class="result-grade">Grade <span class="result-grade-num">' + j[e].grade + "</span></span></div></li></ul>";
            s += "</article>"
        }
    }
    history.replaceState("", "", "#no" + c), $("#info-ic").html('<img src="' + u + '" alt="">'), $("#info-name span").text(d), $("#info-grade span").text(o), $("#info-type span").text(h), $("#info-rare span").text(l), $("#result").html(s), now = $("#search").val(), $("#info-prop li").each(function(a) {
        $("span", this).html(k[a])
    })
}
$(function() {
	function clean(){
        $("#info-name span, #info-grade span, #info-type span, #info-rare span").text(" ");
		$("#info-ic, #result, #search").empty()
	}
    function a() {
        clean(),1 == flag && window.history.pushState(location.hash, null), result(search.val())
    }
    flag = !1, now = "",search = $("#search"), $("head").append("<style></style>"), $("#search-btn").click(function() {
        "" != search.val() && search.val() != now && a()
    }), search.keypress(function(i) {
        13 == i.which && "" != search.val() && search.val() != now && a()
    }), $('input[type="checkbox"]').change(function() {
        if ($(this).prop("checked")) $("head style").append("." + $(this).attr("id") + "{display:none !important}");
        else {
            var a = "." + $(this).attr("id") + "{display:none !important}";
            $("head style").html($("head style").html().replace(a, ""))
        }
    }),  $(window).on("load hashchange", function(){
        clean();
        if (searchHash = location.hash.substring(3), "" != searchHash)
            for (let a in data)
                for (let i in data[a].list) 
                    if (data[a].list[i].no == searchHash) {
                      result(data[a].list[i].name);
                      return search.val(data[a].list[i].name);
                    }
    }).one("load", function() {
        flag = 1, $("#search-remove input").prop("checked", !1)
    })
})  ;
